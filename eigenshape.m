%start clean
close all;
clear all;
clc;

iVec = [-0.0018691588785046676, 1.0252179376423467;...
0.031775700934579446, 0.9579203644074452;...
0.09532710280373831, 0.9052658446556192;...
0.1644859813084112, 0.8631037461713658;...
0.23177570093457944, 0.83565145684442;...
0.2953271028037383, 0.8082070211262076;...
0.36074766355140186, 0.7954645409565695;...
0.42990654205607476, 0.7827142071781984;...
0.4691588785046729, 0.7616233409251552;...
0.502803738317757, 0.7090316500431948;...
0.5308411214953271, 0.6585525799104689;...
0.5532710280373832, 0.618589491871515;...
0.5850467289719626, 0.5786067698107281;...
0.6205607476635514, 0.5239103117882667;...
0.6598130841121496, 0.4986177648629546;...
0.6822429906542056, 0.492268122202152;...
0.7084112149532711, 0.5153223906384984;...
0.7327102803738318, 0.5299772245346739;...
0.7476635514018691, 0.5593575748056232;...
0.7719626168224298, 0.6034241734076808;...
0.8037383177570094, 0.6264666614309276;...
0.811214953271028, 0.6516610382470747;...
0.8261682242990654, 0.7062514725516376;...
0.8485981308411215, 0.7482211576219273;...
0.8672897196261683, 0.7586860912589335;...
0.8598130841121494, 0.7923152438545512;...
0.8672897196261683, 0.8112070996622949;...
0.8953271028037383, 0.8111481975967958;...
0.919626168224299, 0.8005929474593576;...
0.908411214953271, 0.8279274326553051;...
0.9009345794392523, 0.8510523835702506;...
0.9028037383177568, 0.869956019791094;...
0.9252336448598131, 0.857303856121888;...
0.9420560747663551, 0.8425626325296474;...
0.9345794392523363, 0.8740909447891306;...
0.9308411214953272, 0.8909055210869394;...
0.9401869158878504, 0.8950875677373753;...
0.9607476635514018, 0.882439330872536;...
0.9775700934579439, 0.8655972669441608;...
0.9738317757009345, 0.8887143642503731;...
0.9719626168224298, 0.9265334171051598;...
0.9831775700934577, 0.9202073352705569;...
1.0037383177570094, 0.905458258069583;...
1.011214953271028, 0.884434147490772;...
1.011214953271028, 0.9117450718605199;...
1.0149532710280373, 0.9348464619492657;...
1.0261682242990655, 0.9411254221314694;...
1.0355140186915888, 0.9200973847482918;...
1.0579439252336447, 0.8780334563732035;...
1.0691588785046728, 0.8191863661352392;...
1.0710280373831775, 0.7666614309275113;...
1.074766355140187, 0.7120317285792823;...
1.0654205607476637, 0.659530354197754;...
1.050467289719626, 0.6112424409015944;...
1.016822429906542, 0.5608929553129663;...
0.9831775700934577, 0.531551873085683;...
0.9551401869158878, 0.5042998507814341;...
0.9214953271028037, 0.4917654912432263;...
0.9457943925233645, 0.48121024110578814;...
0.9626168224299063, 0.46856985784968197;...
0.9775700934579439, 0.4517317207256736;...
0.988785046728972, 0.42439723552972597;...
1.016822429906542, 0.42223749312809244;...
1.0429906542056073, 0.4074766355140188;...
1.0448598130841122, 0.37806094400376977;...
1.0261682242990655, 0.36129348935836025;...
1.0018691588785045, 0.3613445378151261;...
0.9775700934579439, 0.3487905442550854;...
0.9476635514018692, 0.325744129427472;...
0.9177570093457943, 0.2921935129191865;...
0.8897196261682243, 0.2670423309510721;...
0.8616822429906541, 0.24399198931909216;...
0.8392523364485981, 0.2146273462656092;...
0.811214953271028, 0.19577868530589815;...
0.7476635514018691, 0.1665004319484804;...
0.6822429906542056, 0.13722610539542934;...
0.6205607476635514, 0.1289523285949895;...
0.5775700934579439, 0.12694180475928707;...
0.525233644859813, 0.13125343595382089;...
0.4915887850467289, 0.12712243776015097;...
0.45981308411214955, 0.13349171444278662;...
0.43551401869158873, 0.12093772088274568;...
0.416822429906542, 0.10417026623733616;...
0.3757009345794392, 0.09375245425272927;...
0.3327102803738317, 0.08754024974475783;...
0.2934579439252336, 0.07291683028351525;...
0.2616822429906542, 0.07298358595774768;...
0.23925233644859806, 0.08983743029922253;...
0.2186915887850467, 0.09828398649179315;...
0.19813084112149532, 0.1046297023482291;...
0.18130841121495328, 0.11727008560433538;...
0.15514018691588788, 0.12362758187387113;...
0.1457943925233645, 0.1383530982486454;...
0.1345794392523364, 0.14257833974711387;...
0.11588785046728971, 0.15732349014372105;...
0.11401869158878504, 0.18043666064556674;...
0.14392523364485982, 0.19718055446477667;...
0.17383177570093455, 0.19711772559491092;...
0.20934579439252332, 0.20124479698421438;...
0.2411214953271028, 0.2116822429906543;...
0.2897196261682242, 0.22418518809392918;...
0.3177570093457944, 0.232529647372968;...
0.36074766355140186, 0.25344773423388056;...
0.3757009345794392, 0.27232388282415787;...
0.36448598130841114, 0.29965836802010537;...
0.35887850467289717, 0.3290819131390875;...
0.35887850467289717, 0.3374852744836253;...
0.302803738317757, 0.3523089609675647;...
0.28411214953271025, 0.3691549517003063;...
0.2672897196261682, 0.3944003769732193;...
0.2616822429906542, 0.41542056074766354;...
0.27102803738317754, 0.42590512840650285;...
0.2803738317757009, 0.43218801539307317;...
0.2878504672897196, 0.44267650985627904;...
0.2504672897196262, 0.4490575669520145;...
0.2261682242990654, 0.4554111364171838;...
0.21121495327102802, 0.4680475928689233;...
0.20560747663551399, 0.4785635749626954;...
0.20934579439252332, 0.4890599230346345;...
0.2261682242990654, 0.49952878347600727;...
0.2616822429906542, 0.5120592162098485;...
0.26915887850467285, 0.5183460300007855;...
0.23925233644859806, 0.5184088588706511;...
0.20560747663551399, 0.5205803816853845;...
0.1626168224299065, 0.5206706981858165;...
0.11962616822429907, 0.5459710987198618;...
0.0897196261682243, 0.5691431712872065;...
0.06915887850467291, 0.5943964501688526;...
0.06542056074766354, 0.628017749155737;...
0.08037383177570094, 0.6363896960653421;...
0.10093457943925231, 0.6321448205450405;...
0.13644859813084115, 0.6257676902536715;...
0.1495327102803738, 0.6257402026231054;...
0.15700934579439252, 0.6236236550695045;...
0.12710280373831773, 0.6383923662923113;...
0.10093457943925231, 0.6510523835702506;...
0.05794392523364485, 0.6721511034320271;...
0.03551401869158878, 0.7058116704625776;...
0.00934579439252338, 0.7373792507657269;...
-0.003738317757009335, 0.7605159820937721;...
-0.014953271028037382, 0.7857496269535852;...
-0.020560747663551385, 0.804668970391895;...
-0.022429906542056066, 0.8319838215660096;...
-0.009345794392523352, 0.8466622162883846;...
0.007476635514018698, 0.8298201523600094;...
0.02429906542056076, 0.8129780884316344;...
0.04112149532710281, 0.7940351841671248;...
0.0635514018691589, 0.77718133982565;...
0.08411214953271028, 0.7645331029608105;...
0.04112149532710281, 0.8234469488730072;...
0.013084112149532715, 0.8613209769889264;...
-0.0018691588785046676, 0.8907641561297416;...
-0.018691588785046717, 0.9349171444278646;...
-0.024299065420560734, 0.9937524542527292;...
];

figure; subplot(1,2,1); plot(iVec(:, 1), iVec(:, 2), '.b');axis('equal');

%make laplacian

[n, d] = size(iVec)

L = sparse(n, n);

for i = 1:n
   L(i, i) = 2;
   
   if i == 1
       L(i, i+1) = -1;
       L(i, n) = -1;
   else if i == n
           L(i, 1) = -1;
           L(i, i-1) = -1;          
   else       
       L(i, i+1) = -1;
       L(i, i-1) = -1;
       end
   end
   
end

nEigs = 10;

[V, D] = eigs(L, 10);
newX = zeros(n, 2);
subplot(1,2,2);
hold on;
p1 = plot(iVec(:, 1), iVec(:, 2),'.b');
p2 = plot(newX(:, 1), newX(:, 2),'.r');
hold off;



for i = 1:nEigs



%V = V*D*V';

newX(:,1) = newX(:,1) + (V(:,i)' * iVec(:,1)) * V(:,i);
newX(:,2) = newX(:,2) + (V(:,i)' * iVec(:,2)) * V(:,i);

%newX(:,1) = iVec(:,1)'*V;
%newX(:,2) = iVec(:,2)'*V;

hold on;
delete(p2);
p2 = plot(newX(:, 1), newX(:, 2),'-r');axis('equal');
hold off;
title(i);
drawnow();

%pause();

end



























